# Example librechat.yml configuration for GitLab MCP integration
version: 1.1.5

# MCP (Model Context Protocol) Configuration
mcp:
  # GitLab MCP Server with Hybrid Authentication
  gitlab:
    name: "GitLab"
    description: "GitLab GraphQL API integration with per-user authentication and optional shared read-only access"
    
    # Docker configuration (recommended for LibreChat)
    docker:
      image: "gitlab-mcp-server"
      containerName: "gitlab-mcp-server"
      
    # Environment variables for GitLab connection
    env:
      GITLAB_URL: "${GITLAB_URL:-https://gitlab.com}"
      # Optional: Shared read-only token for public operations
      GITLAB_SHARED_ACCESS_TOKEN: "${GITLAB_SHARED_ACCESS_TOKEN:-}"
      # Authentication mode: 'shared', 'per-user', or 'hybrid' (default)
      GITLAB_AUTH_MODE: "${GITLAB_AUTH_MODE:-hybrid}"
      GITLAB_MAX_PAGE_SIZE: "${GITLAB_MAX_PAGE_SIZE:-50}"
      GITLAB_TIMEOUT: "${GITLAB_TIMEOUT:-30000}"
    
    # User Authentication Configuration
    userAuth:
      enabled: true
      description: "Users can provide their own GitLab credentials for full access including write operations"
      fields:
        - name: "accessToken"
          type: "password"
          required: true
          description: "Your GitLab Personal Access Token (with api or read_api scope)"
        - name: "gitlabUrl"
          type: "url"
          required: false
          description: "GitLab instance URL (optional, uses server default if not provided)"
          default: "${GITLAB_URL:-https://gitlab.com}"
    
    # Available tools
    tools:
      # Read-only operations (can use shared token if available)
      - name: "get_project"
        description: "Get detailed project information (read-only, can use shared token)"
        auth: "optional"
      - name: "get_issues"
        description: "Get project issues (read-only, can use shared token)"
        auth: "optional"
      - name: "get_merge_requests"
        description: "Get project merge requests (read-only, can use shared token)"
        auth: "optional"
      - name: "execute_custom_query"
        description: "Execute custom GraphQL queries (auth required for private data)"
        auth: "optional"
      - name: "get_available_queries"
        description: "List available GraphQL queries and mutations"
        auth: "optional"
        
      # User authentication required
      - name: "get_current_user"
        description: "Get current GitLab user information"
        auth: "required"
      - name: "get_projects" 
        description: "List accessible GitLab projects (shows private projects with auth)"
        auth: "required"
        
      # Write operations (always require user authentication)
      - name: "create_issue"
        description: "Create a new issue (requires user authentication)"
        auth: "required"
        permissions: "write"
      - name: "create_merge_request"
        description: "Create a new merge request (requires user authentication)"
        auth: "required"
        permissions: "write"
        
      # Search and exploration tools (perfect for LLMs)
      - name: "search_gitlab"
        description: "Search across all GitLab (projects, issues, merge requests) - ideal for LLM exploration"
        auth: "optional"
      - name: "search_projects"
        description: "Search for projects by name or description"
        auth: "optional"
      - name: "search_issues"
        description: "Search for issues globally or within specific projects"
        auth: "optional"
      - name: "search_merge_requests"
        description: "Search for merge requests and code changes"
        auth: "optional"
      - name: "search_users"
        description: "Find users and team members"
        auth: "optional"
      - name: "search_groups"
        description: "Search groups and organizations"
        auth: "optional"
      - name: "browse_repository"
        description: "Browse repository files and folder structure"
        auth: "optional"
      - name: "get_file_content"
        description: "Get the content of specific files for code analysis"
        auth: "optional"